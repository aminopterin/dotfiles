# filename: makefile
# author: Tzu-Yu Jeng
# date: Jan. 2017
# description: to export all `.tex` (xeLaTeX) files possibly with CJK, into `.pdf`
# requirement: having assumed pandoc and xelatex being installed

# to call bash shell for recipe
SHELL := /usr/bin/env bash

# to specify location of program
PRG := ~/run-xelatex.sh

# to hold message displayed in the beginning
MSG := Now exporting all xeLaTeX's to Pdf's in the current directory...

# to set the xeLaTeX source files, either in root or in a subfolder (but no deeper);
# it's forbidden to contain whitespace ` ` in filename, or Makefile would separate them
SRCS = $(wildcard *.tex **/*.tex)

# to replace all `.tex` with `.pdf`
PDFS = $(SRCS:.tex=.pdf)

# other affiliated files
AFF = $(wildcard *.aux **/*.aux) $(wildcard *.log **/*.log) $(wildcard *.gz **/*.gz)

# to delete binary files
RM := rm -f

# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #

# for release
all : message $(PDFS)

# output pre-build message
message :
	@echo $(MSG)

./%.pdf : ./%.tex
	@echo Compiling "$@" from "$<" ...
	@$(PRG) "$<"

.PHONY : all message clean 

clean :
	$(RM) $(PDFS) $(AFF)

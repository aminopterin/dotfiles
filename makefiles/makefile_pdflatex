# filename: makefile
# author: Tzu-Yu Jeng
# date: Jan. 2017
# description: to export all `.tex` (LaTeX) files without CJK, into `.pdf`
# requirement: having assumed pandoc and xelatex being installed

# to call bash shell for recipe
SHELL := /usr/bin/env bash

# to specify location of program
PRG := $${HOME}/run_pdflatex.sh

# to hold message displayed in the beginning
MSG := Now exporting all LaTeX's to Pdf's in the current directory...

# to set the LaTeX source files, either in root or in a subfolder (but no deeper);
# it's forbidden to contain whitespace ` ` in filename, or Makefile would separate them
SRC = $(wildcard *.tex */*.tex */*/*.tex)

# to replace all `.tex` with `.pdf`
PDF = $(SRC:.tex=.pdf)

# other affiliated files
AUX = $(wildcard *.aux */*.aux */*/*.aux)
LOG = $(wildcard *.log */*.log */*/*.log)
GZ = $(wildcard *.gz */*.gz */*/*.gz)

# to delete binary files
RM := rm -f

# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #

# for release
all : message $(PDF)

# output pre-build message
message :
	@echo $(MSG)

./%.pdf : ./%.tex
	@echo Compiling "$@" from "$<" ...
	@$(PRG) "$<"

.PHONY : all message clean 

clean :
	$(RM) "$(PDF)" "$(AUX)" "$(LOG)" "$(GZ)"
